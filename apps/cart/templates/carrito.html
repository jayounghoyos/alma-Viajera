{% extends "base.html" %}
{% load static %}

{% block title %}Carrito de Compras{% endblock %}

{% block body_class %}cart{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/carrito.css' %}">

<main class="container">
    <h1>Tu Carrito de Compras</h1>

    {% if carrito %}
    <div class="cart-layout">
        <div class="cart-items">
            {% for item in carrito.items.all %}
            <div class="cart-item">
                <img src="{{ item.item_id.imagen.url }}" alt="{{ item.item_id.nombre }}" class="product-image">
                <div class="item-details">
                    <span class="item-name">{{ item.item_id.nombre }}</span>
                    <div class="item-controls">
                        <button class="quantity-btn" data-action="decrease" data-item-id="{{ item.id }}">-</button>
                        <span class="quantity">{{ item.cantidad }}</span>
                        <button class="quantity-btn" data-action="increase" data-item-id="{{ item.id }}">+</button>
                    </div>
                    <span class="item-price">${{ item.item_id.precio|floatformat:2 }}</span>
                </div>
                <button class="remove-btn" data-item-id="{{ item.id }}">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
            {% endfor %}
        </div>

        <div class="cart-summary">
            <h2>Resumen de Compra</h2>
            <div class="summary-line">
                <span>Subtotal:</span>
                <span>${{ carrito.total|floatformat:2 }}</span>
            </div>
            <div class="summary-line">
                <span>Env√≠o:</span>
                <span>Gratis</span>
            </div>
            <div class="summary-line total">
                <span>Total:</span>
                <span>${{ carrito.total|floatformat:2 }}</span>
            </div>
            <button class="checkout-btn">Realizar reserva</button>
        </div>
    </div>
    {% else %}
        <p>{{ error }}</p>
    {% endif %}
</main>

<script>
    function toggleCart() {
        const cartPopup = document.getElementById('cart-popup');
        cartPopup.classList.toggle('active');
    }
</script>
{% endblock %}